"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var CLASS_NAME_SELECT="select",CLASS_NAME_ACTIVE="select_show",CLASS_NAME_SELECTED="select__option_selected",SELECTOR_ACTIVE=".select_show",SELECTOR_DATA="[data-select]",SELECTOR_DATA_TOGGLE='[data-select="toggle"]',SELECTOR_OPTION_SELECTED=".select__option_selected",CustomSelect=function(){function e(t,o){_classCallCheck(this,e),this._elRoot="string"==typeof t?document.querySelector(t):t,this._params=o||{},this._params.options&&(this._elRoot.classList.add(CLASS_NAME_SELECT),this._elRoot.innerHTML=e.template(this._params)),this._elToggle=this._elRoot.querySelector(SELECTOR_DATA_TOGGLE),this._elHidden=this._elRoot.querySelector("input[type=hidden]"),this._elRoot.addEventListener("click",this._onClick.bind(this)),this._params.search&&this._oninput(this._elRoot,this._params)}return _createClass(e,[{key:"_onClick",value:function(e){var t=e.target;switch(t.closest(SELECTOR_DATA).dataset.select){case"toggle":this.toggle();break;case"option":this._changeValue(t)}}},{key:"_update",value:function(e){e=e.closest(".select__option");var t=this._elRoot.querySelector(SELECTOR_OPTION_SELECTED);return t&&t.classList.remove(CLASS_NAME_SELECTED),e.classList.add(CLASS_NAME_SELECTED),"search"===this._elToggle.dataset.type?(this._elToggle.value=e.textContent,this._elHidden.value=e.dataset.value):(this._elToggle.textContent=e.textContent,this._elToggle.value=e.dataset.value,this._elRoot.classList.add("_selected")),this._elToggle.dataset.index=e.dataset.index,this._elRoot.dispatchEvent(new CustomEvent("select.change")),this._params.onSelected&&this._params.onSelected(this,e),e.dataset.value}},{key:"_reset",value:function(){var e=this._elRoot.querySelector(SELECTOR_OPTION_SELECTED);return e&&e.classList.remove(CLASS_NAME_SELECTED),this._elToggle.textContent="Выберите из списка",this._elToggle.value="",this._elToggle.dataset.index=-1,this._elRoot.dispatchEvent(new CustomEvent("select.change")),this._params.onSelected&&this._params.onSelected(this,null),""}},{key:"_changeValue",value:function(e){e.classList.contains(CLASS_NAME_SELECTED)||(this._update(e),this.hide())}},{key:"_oninput",value:function(e,t){var o=this;this._elToggle.addEventListener("input",(function(){var e=o._elToggle.value.trim(),n=[];if(""!==e)t.options.forEach((function(t,a){var s="_hide",i=t[1];-1!==i.search(e)&&(s="",i=o._insertMark(i,i.search(e),e.length)),n.push('<li class="select__option '.concat(s,'" data-select="option" data-value="').concat(t[0],'" data-index="').concat(a,'">').concat(i,"</li>"))})),o._elRoot.querySelector(".select__options").innerHTML=n.join("");else{var a=[];t.options.forEach((function(e,t){a.push('<li class="select__option" data-select="option" data-value="'.concat(e[0],'" data-index="').concat(t,'">').concat(e[1],"</li>"))})),o._elRoot.querySelector(".select__options").innerHTML=a.join("")}}))}},{key:"_insertMark",value:function(e,t,o){return e.slice(0,t)+"<mark>"+e.slice(t,t+o)+"</mark>"+e.slice(t+o)}},{key:"show",value:function(){document.querySelectorAll(SELECTOR_ACTIVE).forEach((function(e){e.classList.remove(CLASS_NAME_ACTIVE)})),this._elRoot.classList.add(CLASS_NAME_ACTIVE)}},{key:"hide",value:function(){this._elRoot.classList.remove(CLASS_NAME_ACTIVE)}},{key:"toggle",value:function(){this._elRoot.classList.contains(CLASS_NAME_ACTIVE)?this.hide():this.show()}},{key:"dispose",value:function(){this._elRoot.removeEventListener("click",this._onClick)}},{key:"value",get:function(){return this._elToggle.value},set:function(e){var t=this,o=!1;if(this._elRoot.querySelectorAll(".select__option").forEach((function(n){if(n.dataset.value===e)return o=!0,t._update(n)})),!o)return this._reset()}},{key:"selectedIndex",get:function(){return this._elToggle.dataset.index},set:function(e){var t=this._elRoot.querySelector('.select__option[data-index="'.concat(e,'"]'));return t?this._update(t):this._reset()}}]),e}();CustomSelect.template=function(e){var t,o=e.name,n=e.options,a=e.targetValue,s=[],i=-1,l="",c="Выберите из списка",r=void 0!==e.placeholder?e.placeholder:"Оберіть із списку або введіть";if(n.forEach((function(e,t){var o="";e[0]===a&&(o=" select__option_selected",i=t,l=e[0],c=e[1]),s.push('<li class="select__option'.concat(o,'" data-select="option" data-value="').concat(e[0],'" data-index="').concat(t,'">').concat(e[1],"</li>"))})),e.search){var _='<input type="text" class="select__input" placeholder="'.concat(r,'" value="').concat(c,'" data-select="toggle" data-type="search" data-index="').concat(i,'">');""===l&&(_='<input type="text" placeholder="'.concat(r,'" class="select__input" data-select="toggle" data-type="search" data-index="').concat(i,'">')),t='\n            <div class="select__toggle">\n                '.concat(_,'\n                <input type="hidden" value="').concat(l,'" name="').concat(o,'">\n            </div>\n        ')}else t='\n            <div class="select__toggle">       \n                <label>'.concat(c,'</label>        \n                <button type="button" name="').concat(o,'" value="').concat(l,'" data-type="button" data-select="toggle" data-index="').concat(i,'"></button>\n            </div>\n        ');return"\n        ".concat(t,'\n        <div class="select__dropdown">\n            <ul class="select__options">').concat(s.join(""),"</ul>\n        </div>\n    ")},document.addEventListener("click",(function(e){e.target.closest(".select")||document.querySelectorAll(SELECTOR_ACTIVE).forEach((function(e){e.classList.remove(CLASS_NAME_ACTIVE)}))}));